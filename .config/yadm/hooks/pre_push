#!/bin/bash
IFS=$(echo -en "\n\b");
arquivo_adicionado=0;
if [[ "$(mount | grep '/dev/sda2 on / type btrfs')" == *"subvol=/ROOT)"* ]];then
    #/home/lucas/.local/share/icons/* #Too many files. It takes to long to verify all of them every time I push my changes. Think mothafocka..
    for i in $(yadm stun /home/lucas/.themes/* \
    /home/lucas/.config/Kvantum/* \
    /home/lucas/Imagens/Wallpaper/* \
    /home/lucas/.config/autostart/* \
    /home/lucas/.local/share/konsole/* \
    /home/lucas/.config/systemd/user/* \
    /home/lucas/.local/share/applications/* \
    /home/lucas/.local/share/color-schemes/* \
    /home/lucas/.local/share/aurorae/themes/* \
    /home/lucas/.local/share/plasma/plasmoids/* \
    /home/lucas/.local/share/plasma/look-and-feel/ \
    /home/lucas/.config/autostart-scripts/* --porcelain); do
        if [ -n "$(echo "$i" | grep '??')" ];then
            yadm add "/home/lucas/$(echo "$i" | cut -d '"' -f2 | tr -d '??' | perl -pe 's/^\s+//')";
            arquivo_adicionado=1;
        fi
    done
    if [[ $arquivo_adicionado -eq 1 || -n "$(yadm diff --name-only)"  ]];then
        yadm status --porcelain;
        echo -e "\nPressione qualquer tecla para continuar";
        read;
        yadm commit -a -m "atualizando";
    fi
else
    echo -e "Você não está no subvolume ROOT. push não realizado";
fi
